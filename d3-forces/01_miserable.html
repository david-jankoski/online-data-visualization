<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Basic datavis html</title>
    <meta name="description" content="A template for creating online data visualizations using d3.js.">
    <script src="https://d3js.org/d3.v4.min.js"></script>
  </head>

  <body>
    <svg width="800" height="800"></svg>
    <script>
      var dataURL = 'https://dominiku.indus.uberspace.de/data/miserables.json';
      
      d3.json(dataURL, function(data){
        console.log(data);

        var svg = d3.select('svg');

        var nodes = data.nodes;
        var links = data.links;

        var redraw = function(){
          var circles = svg.selectAll('circle').data(nodes);

          circles.enter()
              .append('circle')
                .attr('r', 5)
              .merge(circles)
                .attr('cx', function(d){ return d.x; })
                .attr('cy', function(d){ return d.y; });
          
          var lines = svg.selectAll('line').data(links);

          lines.enter()
            .append('line')
              .style('stroke', '#333')
            .merge(lines)
              .attr('x1', function(d){ return d.source.x; })
              .attr('y1', function(d){ return d.source.y; })
              .attr('x2', function(d){ return d.target.x; })
              .attr('y2', function(d){ return d.target.y; });
        }

        var centeringForce = d3.forceCenter(400, 400);
        var gravity = d3.forceManyBody()
          .strength(-30);
        var linkForce = d3.forceLink(links)
          .id(function(d){ return d.id; });

        var sim = d3.forceSimulation()
          .nodes(nodes)
          .force("center", centeringForce)
          .force("gravity", gravity)
          .force("links", linkForce)
          .on('tick', redraw);

      });
      
    </script>
  </body>
</html>